<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        #box{
            position: absolute;
            top: 100px;
            left: 200px;
            margin: 0 auto;
            width: 600px;
            height: 200px;
            border: 1px solid #eee;
            text-align: center;
        }
        #content{
            position: relative;
            margin:20px auto;
            width: 400px;
            height: 100px;
            font: 60px/160px open Sans;
            background: url() no-repeat;
        }
        #control{
            position: absolute;
            left: 1000px;
            top: 200px;
            width: 60px;
            height: 60px;
        }
        #{
            position: absolute;
            left: 1000px;
            top: 230px;
            width: 200px;
            border: 1px solid #eee;
            display: none;
        }
    </style>
</head>
<body>
    <div id="box">
        <p id="content"></p>
        <button id="yes">到了</button>
        <button id="not">没到</button>
    </div>
    <button id="control">开始点名</button>
    <button id="show">展示未到人员名单</button>
    <div id="showbox">

    </div>
    <script>
        var list={
            "0":{
                "flag":false,
                "name":"wph"
            },
            "1":{
                "flag":false,
                "name":"a"
            },
            "2":{
                "flag":false,
                "name":"b"
            },
            "3":{
                "flag":false,
                "name":"c"
            },
            "4":{
                "flag":false,
                "name":"d"
            },
            "5":{
                "flag":false,
                "name":"e"
            },
            "6":{
                "flag":false,
                "name":"f"
            },
            "7":{
                "flag":false,
                "name":"g"
            },
            "8":{
                "flag":false,
                "name":"h"
            },
            "9":{
                "flag":false,
                "name":"i"
            },
            "10":{
                "flag":false,
                "name":"j"
            }
        }
        var newNode;
        var doing=true;
        var index;
        var randomIndex=[];
        var count=0;
        for(var k in list){
            count++;
        }
        var num=parseInt(Math.random()*count);
        console.log(num);
        randomIndex.push(num);

        function randomName(json){
            for(var i=0;i<randomIndex.length;i++){
                if(num==randomIndex[i]){
                    num=parseInt(Math.random()*count);
                    continue;
                }
            }
            randomIndex.push(num);
            console.log(randomIndex.length);
            if(randomIndex.length>=count){
                doing=false;
            }else{
                return num;
            }   
        }
        
        function addNode(){
            index=String(randomName(list));
            if(index>0){
                newNode=document.createElement("span");
                newNode.innerHTML=list[index].name;
                content.appendChild(newNode);
            }else{
                alert("您好，点名已经结束");
            }
        }
        
        //是否正在点名
        control.onclick=function(){
            if(doing){
                addNode();
                control.innerHTML=control.innerHTML=="开始点名"?"结束点名":"开始点名";
            }else{
                alert("您好，点名已经结束");
            }
        };
        
        yes.onmousedown=function(){
            list[index].flag=true;
            newNode.style.color="green";
        };
        yes.onmouseup=function(){
            content.removeChild(newNode);
            addNode();
        };

        not.onmousedown=function(){
            list[index].flag=false;
            newNode.style.color="red";
        };
        not.onmouseup=function(){
            content.removeChild(newNode);
            addNode();
        }

        show.onclick=function(){
            var loseName=[];
            for(var k in list){
                if(list[k].flag==false){
                    loseName.push(list[k].name);
                }
            }
            showbox.style.display="block";
            for(var i=0;i<loseName.length;i++){
                var n=document.createElement("p");
                n.innerHTML=loseName[i];
                showbox.appendChild(n);
            }
        }
    </script>
</body>
</html>